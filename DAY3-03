# Load libraries (if not already loaded)
library(tidyverse)
library(statsmodels)  # For linear regression modeling

# Read data (assuming the file is in your working directory)
data <- read.csv("diabetes.csv")

# Explore data (optional)
str(data)  # Check data structure

# Feature selection
age <- data$Age  # Assuming "Age" represents age
diabetes <- ifelse(data$Outcome == 0, 0, 1)  # Create binary variable (0: not diagnosed, 1: diagnosed)

# Linear Regression Analysis
# Model fitting
model_lr <- lm(diabetes ~ age, data = data)

# Model summary
summary(model_lr)

# Optional: Multiple Regression Analysis (consider other relevant features)
# ... (you can add code for feature selection, model fitting with additional features, and summary here)

# Optional: Visualization
# Scatter plot (diabetes diagnosis vs age)
ggplot(data, aes(x = Age, y = diabetes)) +
  geom_point(alpha = 0.5) +  # Adjust point transparency
  labs(title = "Diabetes Diagnosis vs. Age (Scatter Plot)",
       x = "Age", y = "Diabetes Diagnosis (0: No, 1: Yes)") +
  theme_bw()

# Line plot for predicted probabilities (based on linear regression, if significant)
if (summary(model_lr)$coefficients[["Pr(>t)"]][2] < 0.05) {
  # Get predicted probabilities from the model (if p-value for age is significant)
  predicted_probs <- predict(model_lr, data = data)
  
  # Line plot for predicted probabilities
  ggplot(data, aes(x = Age, y = predicted_probs)) +
    geom_line(color = "blue") +
    labs(title = "Predicted Probability of Diabetes Diagnosis (Linear Regression)",
         x = "Age", y = "Predicted Probability") +
    theme_bw()
}
